<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Raritan PX2/PX3 JSON-RPC API: Java JSON-RPC Client Binding</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Raritan PX2/PX3 JSON-RPC API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Java JSON-RPC Client Binding </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Examples</h2>
<h3>Getting device information:</h3>
<div class="fragment"><div class="line"><span class="keyword">import</span> com.raritan.idl.pdumodel.Pdu_2_0_0;</div><div class="line"><span class="keyword">import</span> com.raritan.json_rpc.Agent;</div><div class="line"><span class="keyword">import</span> com.raritan.json_rpc.pdumodel.Pdu_2_0_0_Proxy;</div><div class="line"></div><div class="line">[...]</div><div class="line"></div><div class="line">Agent agent = <span class="keyword">new</span> Agent(<span class="stringliteral">&quot;https://my-px.raritan.com&quot;</span>);</div><div class="line">agent.setUsername(<span class="stringliteral">&quot;agent&quot;</span>);</div><div class="line">agent.setPassword(<span class="stringliteral">&quot;password&quot;</span>);</div><div class="line"></div><div class="line">Pdu_2_0_0 pdu = <span class="keyword">new</span> Pdu_2_0_0_Proxy(agent, <span class="stringliteral">&quot;/model/pdu/0&quot;</span>);</div><div class="line">Pdu_2_0_0.MetaData metadata = pdu.getMetaData()._ret_;</div><div class="line">System.out.println(<span class="stringliteral">&quot;Firmware version: &quot;</span> + metadata.fwRevision);</div></div><!-- fragment --><h3>Power-cycling an outlet:</h3>
<div class="fragment"><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> com.raritan.idl.pdumodel.Outlet;</div><div class="line"><span class="keyword">import</span> com.raritan.idl.pdumodel.Pdu_2_0_0;</div><div class="line"><span class="keyword">import</span> com.raritan.json_rpc.Agent;</div><div class="line"><span class="keyword">import</span> com.raritan.json_rpc.pdumodel.Pdu_2_0_0_Proxy;</div><div class="line"></div><div class="line">[...]</div><div class="line"></div><div class="line">Agent agent = <span class="keyword">new</span> Agent(<span class="stringliteral">&quot;https://my-px.raritan.com&quot;</span>);</div><div class="line">agent.setUsername(<span class="stringliteral">&quot;agent&quot;</span>);</div><div class="line">agent.setPassword(<span class="stringliteral">&quot;password&quot;</span>);</div><div class="line"></div><div class="line">Pdu_2_0_0 pdu = <span class="keyword">new</span> Pdu_2_0_0_Proxy(agent, <span class="stringliteral">&quot;/model/pdu/0&quot;</span>);</div><div class="line">List&lt;Outlet_1_3_3&gt; outlets = pdu.getOutlets()._ret_;</div><div class="line">outlets.get(0).cyclePowerState();</div></div><!-- fragment --><h2>IDL-to-Java Mapping</h2>
<h3>Modules and Java Packages</h3>
<p>The classes implementing Raritan JSON-RPC communication are contained in two separate Java package hierarchy: The namespace <code>com.raritan.idl</code> contains Java interface declarations for all IDL interfaces, and Java equivalents for named IDL data types like structures or enumerations. The <code>com.raritan.json_rpc</code> namespace contains proxy classes that implement those interfaces and relay any method calls to a remote device using JSON-RPC.</p>
<h3>Interfaces and Methods</h3>
<p>IDL interfaces are mapped to Java interfaces and implemented by proxy classes. Each method defined in IDL maps to three overloaded methods in the corresponding Java interface:</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>CreateAccountResult {</div><div class="line">    <span class="keyword">public</span> <span class="keywordtype">int</span> _ret_;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Version 1: synchronous method call</span></div><div class="line">CreateAccountResult createAccount(String username, String password) <span class="keywordflow">throws</span> Exception;</div><div class="line"></div><div class="line"><span class="comment">// Version 2: asynchronous method call</span></div><div class="line">AsyncRequest createAccount(String username, String password,</div><div class="line">                           AsyncRpcResponse&lt;CreateAccountResult&gt; rsp);</div><div class="line"></div><div class="line"><span class="comment">// Version 3: asynchronous method call with custom options</span></div><div class="line">AsyncRequest createAccount(String username, String password,</div><div class="line">                           AsyncRpcResponse&lt;CreateAccountResult&gt; rsp,</div><div class="line">                           RpcCtrl rpcCtrl);</div></div><!-- fragment --><ol type="1">
<li>A synchronous variant which takes the same arguments as the IDL method declaration. This method will block the calling thread until the JSON-RPC communication is finished and the result is available. If the method has a return value or out-parameters those will be included in the result object returned by the method. <br />
 This version of the method is the only one that may throw a Java exception in case of communication problems or an error response from the server.</li>
<li>An asynchronous variant. This version of the method returns immediately without performing any network communication. Instead, the request is processed by a background thread. When it is finished, a method of the passed <code>rsp</code> response object is called: <code>onSuccess</code> in case the JSON-RPC call was successful, or <code>onFailure</code> when there was an error.</li>
<li>An asynchronous variant with custom options. By default, the background thread can combine multiple method calls into a single HTTP request. If that's not desired it can be suppressed by setting an option in the passed <code>rpcCtrl</code> object.</li>
</ol>
<h3>Structures</h3>
<p>IDL structures are mapped to Java classes with public members for each structure element. Those classes feature a default constructor and implement the <code>Cloneable</code> interface.</p>
<h3>Enumerations, Vectors and Maps</h3>
<p>IDL enumerations are mapped to plain Java enums. Vectors are mapped to java.util.List, and maps are mapped to java.util.Map.</p>
<h3>Exceptions</h3>
<p>Exceptional error conditions may occur because of communication problems or because of system errors that occur on the server while processing a request. Those "unexpected" error conditions are not a part of the regular IDL signature, so they are handled by using one of the following exceptions:</p>
<ul>
<li><p class="startli"><code>raritan.rpc.json_rpc.RpcRequestException</code></p>
<p class="startli">This exception is raised in case of a communication failure. Typical examples for this include an unreachable server, an authentication problem or a wrong resource ID.</p>
</li>
<li><p class="startli"><code>raritan.rpc.json_rpc.RpcErrorException</code></p>
<p class="startli">This exception is raised in case the server responded with a JSON-RPC error object instead of the expected method result. This can indicate either an internal problem in the server or a malformed request from the client.</p>
</li>
<li><p class="startli"><code>raritan.rpc.json_rpc.RpcFormatException</code></p>
<p class="startli">This exception is raised in case the JSON-RPC response from the server cannot be decoded. This may indicate an interface version mismatch between client and server.</p>
</li>
</ul>
<p>For synchronous method invocations the exceptions are thrown and can be intercepted with a try/catch block. For asynchronous method invocations the exception object is passed to the <code>onFailure</code> method of the result object.</p>
<h2>Interface Versions</h2>
<p>The Java bindings contain interfaces and proxies for all IDL interface versions that have been released up to the firmware release the bindings were generated for. Using those classes client programs can be written to be compatible with any firmware version up until the most recent release.</p>
<p>IDL interface names like <code>pdumodel.Pdu_3_1_0</code> contain three separate version numbers:</p>
<ol type="1">
<li>A <em>major</em> version. This number is incremented when the interface has changed in an incompatible way. A client program that is written to support Pdu_2_* may or may not work with a device that implements the Pdu_3_* interface.</li>
<li>The middle number is the <em>sub-major</em> version. This number is incremented in case a referenced interface is changed in an incompatible way. A client can safely ignore the middle version number as long as it uses only methods of the interface itself. However, it should verify the type and version of any objects returned from an interface with a different sub-major number before using them.</li>
<li>The last number, the <em>minor</em> version, is incremented on backward- compatible interface changes, e.g. when a new method was introduced. A client that was written to support the <code>Pdu_3_1_0</code> interface is guaranteed to work with <code>Pdu_3_1_1</code> or later without modification. Object references returned from an interface with compatible changes can be safely used without additional compatibility checks.</li>
</ol>
<p>See the DumpPdu.java program distributed with this documentation for an example how to write a client program that supports multiple interface versions.</p>
<h2>Bulk Requests</h2>
<p>The Bulk RPC interface allows combining multiple JSON-RPC method calls into a single bulk request that can be sent to the server and processed in a single HTTP request. When using the asynchronous API the Java client library automatically adds all submitted requests into a bulk request queue. A background thread combines pending requests into a bulk request and sends it to the device. As a result, submitted requests can be delayed by up to 250 Milliseconds while the bulk RPC thread waits for more requests to be queued.</p>
<p>To bypass the bulk request queue, add an <code>rpcCtrl</code> parameter to the asynchronous method call. The following call will be immediately sent to the device as a dedicated JSON-RPC request:</p>
<div class="fragment"><div class="line">Net_4_0_0 <a class="code" href="namespacenet.html">net</a> = <span class="keyword">new</span> Net_4_0_0_Proxy(agent, <span class="stringliteral">&quot;/net&quot;</span>);</div><div class="line"></div><div class="line"><a class="code" href="namespacenet.html">net</a>.getSettings(<span class="keyword">new</span> AsyncRpcResponse&lt;Net_4_0_0.GetSettingsResult&gt;() {</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> onSuccess(Net_4_0_0.GetSettingsResult result) {</div><div class="line">        ...</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> onFailure(Exception e) {</div><div class="line">        ...</div><div class="line">    }</div><div class="line"></div><div class="line">}, <span class="keyword">new</span> RpcCtrl(RpcCtrl.Bulk.FORBID));</div></div><!-- fragment --><h2>com.raritan.json_rpc.Agent Method Reference</h2>
<h3>Constructor: Agent(url)</h3>
<p>Creates a new agent.</p>
<p>Parameters:</p><ul>
<li><b>url</b> Base URL of the device (e.g. "https://my-device.example.com")</li>
</ul>
<p>It is necessary to call setUsername()/setPassword() or setToken() before the first request.</p>
<h3>setUsername(user)</h3>
<p>This method sets the username for HTTP basic authentication.</p>
<p>Parameters:</p><ul>
<li><b>user</b> User Name</li>
</ul>
<h3>setPassword(password)</h3>
<p>This method sets the password for HTTP basic authentication.</p>
<p>Parameters:</p><ul>
<li><b>password</b> Password</li>
</ul>
<h3>setToken(token)</h3>
<p>This method enables and disables HTTP authentication using a session token. A session token can be obtained by calling the newSession method of the session.SessionManager interface.</p>
<p>Calling setToken(token) with a string variable which contains the token will enable token-based authentication.</p>
<p>When calling setToken(null), token-based authentication is disabled.</p>
<p>Parameters:</p><ul>
<li><b>token</b> Session Token (null or string with session token) </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Mar 1 2020 22:52:43 for Raritan PX2/PX3 JSON-RPC API by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
